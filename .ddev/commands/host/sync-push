#!/bin/bash
set -e

# 1. Esporta il database (COMMENTATO PER TEST)
# echo "ğŸ“¦ Esportazione del database..."
# ddev export-db --gzip=false --file=data_sync.sql

# 2. Operazioni Git
echo "ğŸš€ Preparazione push su Git..."
git add .

MSG=${1:-"Sync No-DB da $(hostname) - $(date +'%d/%m/%Y %H:%M')"}

echo "ğŸ“ Commit in corso..."
# Usiamo || true per non far fallire lo script se non c'Ã¨ nulla da committare
git commit -m "$MSG" || echo "âšª Nulla di nuovo da committare"

echo "ğŸ”„ Sincronizzazione con GitHub (Pull)..."
# Scarica i cambiamenti remoti e mette i tuoi sopra
git pull origin main --rebase

echo "ğŸ“¤ Upload su GitHub..."
git push origin main

echo "âœ¨ Test No-DB completato!"
